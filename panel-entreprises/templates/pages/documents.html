{% extends "index.html" %}

{% block content %}
<div class="documents-page">
    <div class="documents-header">
        <h1>Documents types</h1>
        <button class="button primary" id="upload-document-button">
            <span class="icon">‚ûï</span>
            Ajouter un document
        </button>
    </div>
    
    <div class="documents-content">
        <div class="documents-filters">
            <div class="filter-group">
                <label for="document-type-filter">Type de document</label>
                <select id="document-type-filter">
                    <option value="all">Tous les types</option>
                    <option value="reglement">R√®glement de consultation</option>
                    <option value="marche">Projet de march√© (CPA)</option>
                    <option value="lettre">Lettre de consultation</option>
                    <option value="grille">Grille d'√©valuation</option>
                    <option value="autre">Autres</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label for="document-search">Rechercher</label>
                <div class="search-input">
                    <input type="text" id="document-search" placeholder="Rechercher un document...">
                    <button class="search-button">üîç</button>
                </div>
            </div>
        </div>
        
        <div class="documents-grid">
            {% if documents %}
                {% for document in documents %}
                <div class="document-card" data-type="{{ document.type }}">
                    <div class="document-icon">
                        {% if document.type == 'reglement' %}
                        üìã
                        {% elif document.type == 'marche' %}
                        üìÑ
                        {% elif document.type == 'lettre' %}
                        ‚úâÔ∏è
                        {% elif document.type == 'grille' %}
                        üìä
                        {% else %}
                        üìë
                        {% endif %}
                    </div>
                    <div class="document-info">
                        <h3>{{ document.name }}</h3>
                        <p class="document-type">
                            {% if document.type == 'reglement' %}
                            R√®glement de consultation
                            {% elif document.type == 'marche' %}
                            Projet de march√© (CPA)
                            {% elif document.type == 'lettre' %}
                            Lettre de consultation
                            {% elif document.type == 'grille' %}
                            Grille d'√©valuation
                            {% else %}
                            Autre
                            {% endif %}
                        </p>
                        <p class="document-date">Ajout√© le {{ document.date }}</p>
                    </div>
                    <div class="document-actions">
                        <a href="{{ document.url }}" class="button secondary download-button" download>
                            <span class="icon">‚¨áÔ∏è</span>
                            T√©l√©charger
                        </a>
                        <button class="action-button preview-button" data-id="{{ document.id }}">üëÅÔ∏è</button>
                        <button class="action-button delete-button" data-id="{{ document.id }}">üóëÔ∏è</button>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="empty-state">
                    <div class="empty-icon">üìÇ</div>
                    <p>Aucun document type disponible pour le moment.</p>
                    <p>Cliquez sur "Ajouter un document" pour t√©l√©verser votre premier document type.</p>
                </div>
            {% endif %}
        </div>
    </div>
    
    <!-- Modal d'ajout de document -->
    <div id="upload-document-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Ajouter un document type</h3>
                <button class="close-button">&times;</button>
            </div>
            <div class="modal-body">
                <form id="upload-document-form" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="document-name">Nom du document</label>
                        <input type="text" id="document-name" name="name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="document-type">Type de document</label>
                        <select id="document-type" name="type" required>
                            <option value="reglement">R√®glement de consultation</option>
                            <option value="marche">Projet de march√© (CPA)</option>
                            <option value="lettre">Lettre de consultation</option>
                            <option value="grille">Grille d'√©valuation</option>
                            <option value="autre">Autre</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="document-description">Description (optionnelle)</label>
                        <textarea id="document-description" name="description" rows="3"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="document-file">S√©lectionnez un fichier</label>
                        <input type="file" id="document-file" name="file" required accept=".docx,.doc,.pdf,.xlsx,.xls">
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="button secondary" id="cancel-upload">Annuler</button>
                        <button type="submit" class="button primary">T√©l√©verser</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Modal de pr√©visualisation de document -->
    <div id="preview-document-modal" class="modal" style="display: none;">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3 id="preview-document-title">Pr√©visualisation du document</h3>
                <button class="close-button">&times;</button>
            </div>
            <div class="modal-body">
                <div id="document-preview" class="document-preview">
                    <!-- Contenu de la pr√©visualisation -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="button secondary" data-close-modal>Fermer</button>
                <a id="preview-download-link" href="#" class="button primary" download>T√©l√©charger</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/documents.js') }}"></script>
{% endblock %}